---
import BaseLayout from "../layouts/BaseLayout.astro";

const repositoryUrl = import.meta.env.PUBLIC_REPO_URL ?? "https://github.com/jnd0/startup-perks";
const siteUrl = Astro.site ?? new URL("https://startup-perks.com");
const rootUrl = new URL("/", siteUrl).toString();
const canonicalUrl = new URL("/contributing/", siteUrl).toString();
const organizationId = `${rootUrl}#organization`;
const websiteId = `${rootUrl}#website`;
const pageId = `${canonicalUrl}#webpage`;

const structuredData = {
  "@context": "https://schema.org",
  "@graph": [
    {
      "@type": "Organization",
      "@id": organizationId,
      name: "StartupPerks",
      url: rootUrl,
      logo: new URL("/favicon.svg", siteUrl).toString(),
      sameAs: [repositoryUrl],
    },
    {
      "@type": "WebSite",
      "@id": websiteId,
      name: "StartupPerks",
      url: rootUrl,
      inLanguage: "en",
      publisher: {
        "@id": organizationId,
      },
    },
    {
      "@type": "WebPage",
      "@id": pageId,
      url: canonicalUrl,
      name: "Contributing | StartupPerks",
      description: "How to contribute startup perks to the open-source StartupPerks directory.",
      inLanguage: "en",
      isPartOf: {
        "@id": websiteId,
      },
      publisher: {
        "@id": organizationId,
      },
    },
    {
      "@type": "HowTo",
      "@id": `${canonicalUrl}#howto`,
      name: "How to add a startup perk",
      description: "Step-by-step process for contributing a new startup perk entry to StartupPerks.",
      totalTime: "PT10M",
      step: [
        { "@type": "HowToStep", position: 1, text: "Fork the repository." },
        { "@type": "HowToStep", position: 2, text: "Add one Markdown file in src/content/perks." },
        { "@type": "HowToStep", position: 3, text: "Fill all required frontmatter fields." },
        { "@type": "HowToStep", position: 4, text: "Run bun run check." },
        { "@type": "HowToStep", position: 5, text: "Open a pull request with source links." },
      ],
      url: canonicalUrl,
      mainEntityOfPage: {
        "@id": pageId,
      },
    },
  ],
};
---

<BaseLayout
  title="Contributing | StartupPerks"
  description="How to contribute startup perks to the open-source StartupPerks directory."
  canonicalUrl={canonicalUrl}
  structuredData={structuredData}
>
  <main class="page-shell">
    <section class="card contribute">
      <p class="contribute__eyebrow">Contribute in minutes</p>
      <h1>How to add a startup perk</h1>
      <ol>
        <li>Fork the repository.</li>
        <li>Add one Markdown file in <code>src/content/perks</code>.</li>
        <li>Fill all required frontmatter fields.</li>
        <li>Run <code>bun run check</code>.</li>
        <li>Open a pull request with source links.</li>
      </ol>

      <p>Full guidance and the copy/paste template are in <code>CONTRIBUTING.md</code> at the repository root.</p>
      <p>You can also use the homepage <code>Submit perk</code> form to open a prefilled GitHub PR flow.</p>

      {
        repositoryUrl && (
          <p>
            Repo URL configured: <a href={repositoryUrl}>{repositoryUrl}</a>
          </p>
        )
      }

      <a class="button contribute-back-link" href="/">Back to perks</a>
    </section>
  </main>
</BaseLayout>

<style>
  .contribute {
    padding: clamp(1.1rem, 2vw + 0.9rem, 2rem);
  }

  .contribute__eyebrow {
    margin: 0;
    font-size: 0.8rem;
    letter-spacing: 0.08em;
    text-transform: uppercase;
    color: var(--muted);
    font-weight: 700;
  }

  h1 {
    margin: 0.3rem 0 0;
    font-family: "Newsreader", Georgia, serif;
    font-size: clamp(1.8rem, 5vw, 2.6rem);
  }

  ol {
    margin: 1rem 0;
    padding-left: 1.2rem;
    color: var(--text);
    line-height: 1.55;
  }

  p {
    margin: 0.75rem 0 0;
    color: var(--muted);
  }

  a {
    color: inherit;
  }

  .button {
    margin-top: 1rem;
  }

  .contribute-back-link {
    background: #fff;
    color: var(--fg);
    border-color: #cbd5e1;
    box-shadow: var(--shadow-sm);
  }

  .contribute-back-link:hover {
    border-color: #94a3b8;
    background: #f8fafc;
  }
</style>
